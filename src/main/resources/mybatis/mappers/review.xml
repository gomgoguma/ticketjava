<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="review">

	<!-- 리뷰리스트 for 마이페이지 -->
	<select id="reviewMypageList" parameterType="ReviewVo" resultType="ReviewVo">
		<![CDATA[
select	
        p.prodname prodName,
        r.review_no reviewNo,
        r.prod_no prodNo,
        r.user_no userNo,
        r.content content,
        r.rating rating,
        to_char(r.regdate, 'yy-mm-dd hh24:mi') regDate
        
from	review r, product p
where	r.prod_no = p.prod_no
and		r.user_no= #{userNo}
order	by reviewNo desc		
]]>
	</select>

	<!-- 리뷰 삭제 at 마이페이지 -->

	<delete id="deleteReview" parameterType="ReviewVo">
		
		<![CDATA[
		
DELETE FROM		review
where			review_no = #{reviewNo}

		]]>
	</delete>

	<!-- 리뷰페이지 for product -->
	<select id="reviewProductList" parameterType="ReviewVo" resultType="ReviewVo">
		<![CDATA[
select
        r.review_no reviewNo,
        r.prod_no prodNo,
        p.prodname prodName,
        r.user_no userNo,
        u.name userName,
        r.content content,
        r.rating rating,
        to_char(r.regdate, 'yy-mm-dd hh24:mi') regDate
        
from	review r, product p, users u
where	r.prod_no = p.prod_no
and     u.user_no = r.user_no
and		r.prod_no = #{prodNo}
order	by regdate desc	
]]>

	</select>

<!-- 리뷰작성 product 
리뷰no 상품no 유저no 컨텐츠 평점 등록일 -->
<insert id="insertReview" parameterType="ReviewVo">
	<![CDATA[
	INSERT INTO review VALUES (
	seq_review_no.nextval,
	#{prodNo}, 
	#{userNo}, 
	#{content}, 
	#{rating}, 
	sysdate
	)
	]]>
</insert>


</mapper>